<svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="0 0 614.21875 1925.984375" style="max-width: 614.219px; background-color: white;" class="flowchart" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="my-svg"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#my-svg .note&gt;*{fill:#eef7ff!important;stroke:#3d7ea6!important;color:#244a5b!important;}#my-svg .note span{fill:#eef7ff!important;stroke:#3d7ea6!important;color:#244a5b!important;}#my-svg .note tspan{fill:#244a5b!important;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"/></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="my-svg_flowchart-v2-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="my-svg_flowchart-v2-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="my-svg_flowchart-v2-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"/></marker><g class="root"><g class="clusters"><g data-look="classic" id="Write" class="cluster"><rect height="408" width="330" y="1509.984375" x="247.12890625" style=""/><g transform="translate(393.60546875, 1509.984375)" class="cluster-label"><foreignObject height="24" width="37.046875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Write</p></span></div></foreignObject></g></g><g data-look="classic" id="DataQuality" class="cluster"><rect height="509.984375" width="453.64453125" y="950" x="66.84765625" style=""/><g transform="translate(251.873046875, 950)" class="cluster-label"><foreignObject height="24" width="83.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>DataQuality</p></span></div></foreignObject></g></g><g data-look="classic" id="Transform" class="cluster"><rect height="256" width="330" y="644" x="142.109375" style=""/><g transform="translate(270.953125, 644)" class="cluster-label"><foreignObject height="24" width="72.3125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Transform</p></span></div></foreignObject></g></g><g data-look="classic" id="Read" class="cluster"><rect height="256" width="598.21875" y="338" x="8" style=""/><g transform="translate(287.984375, 338)" class="cluster-label"><foreignObject height="24" width="38.25"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Read</p></span></div></foreignObject></g></g><g data-look="classic" id="Init" class="cluster"><rect height="280" width="282.921875" y="8" x="165.6484375" style=""/><g transform="translate(296.4375, 8)" class="cluster-label"><foreignObject height="24" width="21.34375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Init</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A1_A2_0" d="M307.109,87L307.109,91.167C307.109,95.333,307.109,103.667,307.109,111.333C307.109,119,307.109,126,307.109,129.5L307.109,133"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_R1_R2_0" d="M222.068,441L212.983,445.167C203.897,449.333,185.726,457.667,185.12,465.722C184.514,473.778,201.473,481.555,209.953,485.444L218.432,489.333"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_T1_T2_0" d="M262.93,747L258.21,751.167C253.49,755.333,244.049,763.667,243.55,771.559C243.05,779.451,251.49,786.902,255.711,790.627L259.931,794.353"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_DQ1_DQ2_0" d="M220.18,1085.035L207.561,1091.863C194.943,1098.69,169.706,1112.345,176.559,1130.067C183.413,1147.788,222.357,1169.576,241.829,1180.47L261.301,1191.364"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_DQ2_DQF_0" d="M273.792,1249.667L261.841,1261.386C249.891,1273.106,225.99,1296.545,214.04,1313.765C202.09,1330.984,202.09,1341.984,202.09,1347.484L202.09,1352.984"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_DQ2_DQP_0" d="M340.427,1249.667L352.377,1261.386C364.328,1273.106,388.228,1296.545,400.179,1315.765C412.129,1334.984,412.129,1349.984,412.129,1357.484L412.129,1364.984"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_W1_W2_0" d="M367.949,1612.984L363.229,1617.151C358.509,1621.318,349.069,1629.651,348.569,1637.543C348.069,1645.435,356.51,1652.886,360.73,1656.612L364.95,1660.337"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_W2_W3_0" d="M367.949,1740.984L363.229,1745.151C358.509,1749.318,349.069,1757.651,347.864,1765.502C346.658,1773.353,353.687,1780.722,357.202,1784.406L360.717,1788.09"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A2_R1_0" d="M307.109,263L307.109,267.167C307.109,271.333,307.109,279.667,307.109,288C307.109,296.333,307.109,304.667,307.109,313C307.109,321.333,307.109,329.667,307.109,337.333C307.109,345,307.109,352,307.109,355.5L307.109,359"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_R1_R2_2" d="M392.151,441L401.236,445.167C410.322,449.333,428.493,457.667,429.099,465.722C429.705,473.778,412.746,481.555,404.266,485.444L395.786,489.333"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_R2_T1_0" d="M307.109,569L307.109,573.167C307.109,577.333,307.109,585.667,307.109,594C307.109,602.333,307.109,610.667,307.109,619C307.109,627.333,307.109,635.667,307.109,643.333C307.109,651,307.109,658,307.109,661.5L307.109,665"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_T1_T2_2" d="M351.289,747L356.009,751.167C360.729,755.333,370.169,763.667,370.669,771.559C371.169,779.451,362.728,786.902,358.508,790.627L354.288,794.353"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_T2_DQ1_0" d="M307.109,875L307.109,879.167C307.109,883.333,307.109,891.667,307.109,900C307.109,908.333,307.109,916.667,307.109,925C307.109,933.333,307.109,941.667,307.109,949.333C307.109,957,307.109,964,307.109,967.5L307.109,971"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_DQ1_DQ2_2" d="M394.039,1091.714L403.287,1097.428C412.535,1103.143,431.031,1114.571,423.816,1130.804C416.6,1147.037,383.673,1168.075,367.21,1178.594L350.746,1189.112"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_DQP_W1_0" d="M412.129,1422.984L412.129,1429.151C412.129,1435.318,412.129,1447.651,412.129,1457.984C412.129,1468.318,412.129,1476.651,412.129,1484.984C412.129,1493.318,412.129,1501.651,412.129,1509.318C412.129,1516.984,412.129,1523.984,412.129,1527.484L412.129,1530.984"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_W1_W2_2" d="M456.309,1612.984L461.029,1617.151C465.749,1621.318,475.189,1629.651,475.689,1637.543C476.188,1645.435,467.748,1652.886,463.528,1656.612L459.307,1660.337"/><path marker-end="url(#my-svg_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_W2_W3_2" d="M456.309,1740.984L461.029,1745.151C465.749,1749.318,475.189,1757.651,476.394,1765.502C477.6,1773.353,470.57,1780.722,467.056,1784.406L463.541,1788.09"/></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(202.08984375, 1319.984375)" class="edgeLabel"><g transform="translate(-13.0546875, -12)" class="label"><foreignObject height="24" width="26.109375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>Yes</p></span></div></foreignObject></g></g><g transform="translate(412.12890625, 1319.984375)" class="edgeLabel"><g transform="translate(-10.2265625, -12)" class="label"><foreignObject height="24" width="20.453125"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"><p>No</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" class="labelBkg" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(307.109375, 60)" id="flowchart-A1-0" class="node default"><rect height="54" width="169.40625" y="-27" x="-84.703125" style="" class="basic label-container"/><g transform="translate(-54.703125, -12)" style="" class="label"><rect/><foreignObject height="24" width="109.40625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Load Glue args</p></span></div></foreignObject></g></g><g transform="translate(307.109375, 200)" id="flowchart-A2-1" class="node default"><rect height="126" width="212.921875" y="-63" x="-106.4609375" style="" class="basic label-container"/><g transform="translate(-76.4609375, -48)" style="" class="label"><rect/><foreignObject height="96" width="152.921875"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Set Spark config<br />- dynamic allocation<br />- shuffle partitions<br />- optimized committer</p></span></div></foreignObject></g></g><g transform="translate(307.109375, 402)" id="flowchart-R1-2" class="node default"><rect height="78" width="528.21875" y="-39" x="-264.109375" style="" class="basic label-container"/><g transform="translate(-234.109375, -24)" style="" class="label"><rect/><foreignObject height="48" width="468.21875"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Resolve input partitions<br />raw///interval=.../data_source=.../year=YYYY/month=MM/day=DD/</p><table></table><p></p></span></div></foreignObject></g></g><g transform="translate(307.109375, 530)" id="flowchart-R2-3" class="node default"><rect height="78" width="204.0625" y="-39" x="-102.03125" style="" class="basic label-container"/><g transform="translate(-72.03125, -24)" style="" class="label"><rect/><foreignObject height="48" width="144.0625"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Read as DataFrame<br />(schema on read)</p></span></div></foreignObject></g></g><g transform="translate(307.109375, 708)" id="flowchart-T1-4" class="node default"><rect height="78" width="260" y="-39" x="-130" style="" class="basic label-container"/><g transform="translate(-100, -24)" style="" class="label"><rect/><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Type casting &amp; normalization</p></span></div></foreignObject></g></g><g transform="translate(307.109375, 836)" id="flowchart-T2-5" class="node default"><rect height="78" width="204.9375" y="-39" x="-102.46875" style="" class="basic label-container"/><g transform="translate(-72.46875, -24)" style="" class="label"><rect/><foreignObject height="48" width="144.9375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Business transforms<br />(joins/aggregates)</p></span></div></foreignObject></g></g><g transform="translate(307.109375, 1038)" id="flowchart-DQ1-6" class="node default"><rect height="126" width="173.859375" y="-63" x="-86.9296875" style="" class="basic label-container"/><g transform="translate(-56.9296875, -48)" style="" class="label"><rect/><foreignObject height="96" width="113.859375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Evaluate rules<br />- schema/type<br />- not null/unique<br />- ranges/enums</p></span></div></foreignObject></g></g><g transform="translate(307.109375, 1216.9921875)" id="flowchart-DQ2-7" class="node default"><polygon transform="translate(-65.4921875, 65.9921875)" class="label-container" points="65.9921875,0 131.984375,-65.9921875 65.9921875,-131.984375 0,-65.9921875"/><g transform="translate(-38.9921875, -12)" style="" class="label"><rect/><foreignObject height="24" width="77.984375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Violations?</p></span></div></foreignObject></g></g><g transform="translate(202.08984375, 1395.984375)" id="flowchart-DQF-9" class="node default"><rect height="78" width="200.484375" y="-39" x="-100.2421875" style="" class="basic label-container"/><g transform="translate(-70.2421875, -24)" style="" class="label"><rect/><foreignObject height="48" width="140.484375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Fail job (no commit)<br />log: DQ summary</p></span></div></foreignObject></g></g><g transform="translate(412.12890625, 1395.984375)" id="flowchart-DQP-11" class="node default"><rect height="54" width="119.59375" y="-27" x="-59.796875" style="" class="basic label-container"/><g transform="translate(-29.796875, -12)" style="" class="label"><rect/><foreignObject height="24" width="59.59375"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Proceed</p></span></div></foreignObject></g></g><g transform="translate(412.12890625, 1573.984375)" id="flowchart-W1-12" class="node default"><rect height="78" width="222.75" y="-39" x="-111.375" style="" class="basic label-container"/><g transform="translate(-81.375, -24)" style="" class="label"><rect/><foreignObject height="48" width="162.75"><div style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Coalesce to target size<br />128–512MB</p></span></div></foreignObject></g></g><g transform="translate(412.12890625, 1701.984375)" id="flowchart-W2-13" class="node default"><rect height="78" width="260" y="-39" x="-130" style="" class="basic label-container"/><g transform="translate(-100, -24)" style="" class="label"><rect/><foreignObject height="48" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Write Parquet (partitioned ds)</p></span></div></foreignObject></g></g><g transform="translate(412.12890625, 1841.984375)" id="flowchart-W3-15" class="node default"><rect height="102" width="260" y="-51" x="-130" style="" class="basic label-container"/><g transform="translate(-100, -36)" style="" class="label"><rect/><foreignObject height="72" width="200"><div style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"><p>Optimized commit<br />--enable-s3-parquet-optimized-committer=1</p></span></div></foreignObject></g></g></g></g></g></svg>